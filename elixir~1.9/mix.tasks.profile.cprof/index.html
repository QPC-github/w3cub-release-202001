
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Mix profile.cprof - Elixir 1.9 - W3cubDocs</title>
  
  <meta name="description" content=" Profiles the given file or expression using Erlang&#39;s cprof tool. ">
  <meta name="keywords" content="mix, profile, cprof, summary, functions, fun, opts, -, elixir, elixir~1.9">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/elixir~1.9/mix.tasks.profile.cprof/">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" integrity="sha256-6/DH7X+2hvUPElJfGsvzm+tgIpmM9zjbYxnpsr6gR1A=" crossorigin="anonymous" href="/assets/application-ebf0c7ed7fb686f50f12525f1acbf39beb6022998cf738db6319e9b2bea04750.css">
  <script type="text/javascript" src="/assets/application-db285287b40ed28fac520fcfd75d7d874692b647b5b5e05968c741dda5de4148.js" integrity="sha256-2yhSh7QO0o+sUg/P1119h0aStke1teBZaMdB3aXeQUg=" crossorigin="anonymous"></script>
  <script src="/json/elixir~1.9.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
        (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-2572770204602497",
            enable_page_level_ads: true
        });
  </script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/elixir~1.9/" class="_nav-link" title="" style="margin-left:0;">Elixir 1.9</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _elixir">
				
				
<h1>  mix profile.cprof  </h1>  <p>Profiles the given file or expression using Erlang's <code class="inline">cprof</code> tool.</p> <p><code class="inline">cprof</code> can be useful when you want to discover the bottlenecks related to function calls.</p> <p>Before running the code, it invokes the <code class="inline">app.start</code> task which compiles and loads your project. Then the target expression is profiled, together with all matching function calls, by setting breakpoints containing counters. These can only be set on BEAM code so BIFs cannot be call count traced.</p> <p>To profile the code, you can use syntax similar to the <a href="../mix.tasks.run/"><code class="inline">mix run</code></a> task:</p> <pre data-language="elixir">mix profile.cprof -e Hello.world
mix profile.cprof -e "[1, 2, 3] |&gt; Enum.reverse |&gt; Enum.map(&amp;Integer.to_string/1)"
mix profile.cprof my_script.exs arg1 arg2 arg3</pre> <p>This task is automatically reenabled, so you can profile multiple times in the same Mix invocation.</p> <h2 id="module-command-line-options" class="section-heading">  Command line options </h2> <ul> <li>
<code class="inline">--matching</code> - only profile calls matching the given <code class="inline">Module.function/arity</code> pattern </li> <li>
<code class="inline">--limit</code> - filters out any results with a call count less than the limit </li> <li>
<code class="inline">--module</code> - filters out any results not pertaining to the given module </li> <li>
<code class="inline">--eval</code>, <code class="inline">-e</code> - evaluate the given code </li> <li>
<code class="inline">--require</code>, <code class="inline">-r</code> - requires pattern before running the command </li> <li>
<code class="inline">--parallel</code>, <code class="inline">-p</code> - makes all requires parallel </li> <li>
<code class="inline">--no-compile</code> - does not compile even if files require compilation </li> <li>
<code class="inline">--no-deps-check</code> - does not check dependencies </li> <li>
<code class="inline">--no-archives-check</code> - does not check archives </li> <li>
<code class="inline">--no-halt</code> - does not halt the system after running the command </li> <li>
<code class="inline">--no-start</code> - does not start applications after compilation </li> <li>
<code class="inline">--no-elixir-version-check</code> - does not check the Elixir version from mix.exs </li> </ul> <h2 id="module-profile-output" class="section-heading">  Profile output </h2> <p>Example output:</p> <pre data-language="elixir">                                                                     CNT
Total                                                                 15
Enum                                                                   6  &lt;--
  Enum."-map/2-lists^map/1-0-"/2                                       4
  Enum.reverse/1                                                       1
  Enum.map/2                                                           1
:elixir_compiler                                                       4  &lt;--
  anonymous fn/1 in :elixir_compiler.__FILE__/1                        3
  anonymous fn/0 in :elixir_compiler.__FILE__/1                        1
String.Chars.Integer                                                   3  &lt;--
  String.Chars.Integer.to_string/1                                     3
:erlang                                                                2  &lt;--
  :erlang.trace_pattern/3                                              2
Profile done over 20229 matching functions</pre> <p>The default output contains data gathered from all matching functions. The left column structures each module and its total call count trace is presented on the right. Each module has its count discriminated by function below. The <code class="inline">&lt;--</code> symbol is meant to help visualize where a new module call count begins.</p> <p>The first row (Total) is the sum of all function calls. In the last row the number of matching functions that were considered for profiling is presented.</p> <p>When <code class="inline">--matching</code> option is specified, call count tracing will be started only for the functions matching the given pattern:</p> <pre data-language="elixir">String.Chars.Integer                                                   3  &lt;--
  String.Chars.Integer.to_string/1                                     3
Profile done over 1 matching functions</pre> <p>The pattern can be a module name, such as <a href="https://hexdocs.pm/elixir/String.html" target="_blank"><code class="inline">String</code></a> to count all calls to that module, a call without arity, such as <code class="inline">String.split</code>, to count all calls to that function regardless of arity, or a call with arity, such as <a href="https://hexdocs.pm/elixir/String.html#split/2" target="_blank"><code class="inline">String.split/2</code></a>, to count all calls to that exact module, function and arity.</p> <h2 id="module-caveats" class="section-heading">  Caveats </h2> <p>You should be aware the profiler is stopped as soon as the code has finished running. This may need special attention, when: running asynchronous code as function calls which were called before the profiler stopped will not be counted; running synchronous code as long running computations and a profiler without a proper MFA trace pattern or filter may lead to a result set which is difficult to comprehend.</p> <p>Other caveats are the impossibility to call count trace BIFs, since breakpoints can only be set on BEAM code; functions calls performed by <code class="inline">:cprof</code> are not traced; the maximum size of a call counter is equal to the host machine's word size (for example, 2147483647 in a 32-bit host).</p>   <h1 class="section-heading" id="summary">  Summary </h1> <h2> Functions </h2>
<dl class="summary-functions summary">   <dt class="summary-signature"> <a href="#profile/2">profile(fun, opts \\ [])</a> </dt> <dd class="summary-synopsis"><p>Allows to programmatically run the <code class="inline">cprof</code> profiler on expression in <code class="inline">fun</code>.</p></dd>  </dl>   <h1 class="section-heading" id="functions">  Functions </h1>    <h3 class="detail-header function" id="profile/2">  <h1 class="signature">profile(fun, opts \\ [])</h1>  </h3>  <p>Allows to programmatically run the <code class="inline">cprof</code> profiler on expression in <code class="inline">fun</code>.</p> <h4 id="profile/2-options" class="section-heading">  Options </h4> <ul> <li>
<code class="inline">:matching</code> - only profile calls matching the given pattern in form of <code class="inline">{module, function, arity}</code>, where each element may be replaced by <code class="inline">:_</code> to allow any value </li> <li>
<code class="inline">:limit</code> - filters out any results with a call count less than the limit </li> <li>
<code class="inline">:module</code> - filters out any results not pertaining to the given module </li> </ul>
<div class="_attribution">
  <p class="_attribution-p">
    © 2012 Plataformatec<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://hexdocs.pm/mix/1.9.1/Mix.Tasks.Profile.Cprof.html" class="_attribution-link" target="_blank">https://hexdocs.pm/mix/1.9.1/Mix.Tasks.Profile.Cprof.html</a>
  </p>
</div>

				
			</div>
			<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
</amp-auto-ads>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
