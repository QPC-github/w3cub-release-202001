
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Plug.Test - Phoenix - W3cubDocs</title>
  
  <meta name="description" content=" Conveniences for testing plugs. ">
  <meta name="keywords" content="plug, test, summary, functions, -, phoenix">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/phoenix/plug/plug.test/">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" integrity="sha256-6/DH7X+2hvUPElJfGsvzm+tgIpmM9zjbYxnpsr6gR1A=" crossorigin="anonymous" href="/assets/application-ebf0c7ed7fb686f50f12525f1acbf39beb6022998cf738db6319e9b2bea04750.css">
  <script type="text/javascript" src="/assets/application-db285287b40ed28fac520fcfd75d7d874692b647b5b5e05968c741dda5de4148.js" integrity="sha256-2yhSh7QO0o+sUg/P1119h0aStke1teBZaMdB3aXeQUg=" crossorigin="anonymous"></script>
  <script src="/json/phoenix.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
        (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-2572770204602497",
            enable_page_level_ads: true
        });
  </script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/phoenix/" class="_nav-link" title="" style="margin-left:0;">Phoenix</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _elixir">
				
				
<h1>  Plug.Test  </h1>  <p>Conveniences for testing plugs.</p> <p>This module can be used in your test cases, like this:</p> <pre data-language="elixir">use ExUnit.Case, async: true
use Plug.Test</pre> <p>Using this module will:</p> <ul> <li>import all the functions from this module </li> <li>import all the functions from the <a href="../plug.conn/"><code class="inline">Plug.Conn</code></a> module </li> </ul> <p>By default, Plug tests checks for invalid header keys, e.g. header keys which include uppercase letters, and raises a <a href="../plug.conn.invalidheadererror/"><code class="inline">Plug.Conn.InvalidHeaderError</code></a> when it finds one. To disable it, set :validate_header_keys_during_test to false on the app config.</p> <pre data-language="elixir">config :plug, :validate_header_keys_during_test, true</pre>   <h1 class="section-heading" id="summary">  Summary </h1> <h2> Functions </h2>
<dl class="summary-functions summary">   <dt class="summary-signature"> <a href="#conn/3">conn(method, path, params_or_body \\ nil)</a> </dt> <dd class="summary-synopsis">
<p>Creates a test connection</p> </dd>   <dt class="summary-signature"> <a href="#delete_req_cookie/2">delete_req_cookie(conn, key)</a> </dt> <dd class="summary-synopsis">
<p>Deletes a request cookie</p> </dd>   <dt class="summary-signature"> <a href="#init_test_session/2">init_test_session(conn, session)</a> </dt> <dd class="summary-synopsis">
<p>Initializes the session with the given contents</p> </dd>   <dt class="summary-signature"> <a href="#put_http_protocol/2">put_http_protocol(conn, http_protocol)</a> </dt> <dd class="summary-synopsis">
<p>Puts the http protocol</p> </dd>   <dt class="summary-signature"> <a href="#put_peer_data/2">put_peer_data(conn, peer_data)</a> </dt> <dd class="summary-synopsis">
<p>Puts the peer data</p> </dd>   <dt class="summary-signature"> <a href="#put_req_cookie/3">put_req_cookie(conn, key, value)</a> </dt> <dd class="summary-synopsis">
<p>Puts a request cookie</p> </dd>   <dt class="summary-signature"> <a href="#recycle_cookies/2">recycle_cookies(new_conn, old_conn)</a> </dt> <dd class="summary-synopsis">
<p>Moves cookies from a connection into a new connection for subsequent requests</p> </dd>   <dt class="summary-signature"> <a href="#sent_informs/1">sent_informs(conn)</a> </dt> <dd class="summary-synopsis">
<p>Return the informational requests that have been sent</p> </dd>   <dt class="summary-signature"> <a href="#sent_pushes/1">sent_pushes(conn)</a> </dt> <dd class="summary-synopsis">
<p>Return the assets that have been pushed</p> </dd>   <dt class="summary-signature"> <a href="#sent_resp/1">sent_resp(conn)</a> </dt> <dd class="summary-synopsis">
<p>Returns the sent response</p> </dd>  </dl>   <h1 class="section-heading" id="functions">  Functions </h1>   <h3 class="detail-header function" id="conn/3">  <span class="signature">conn(method, path, params_or_body \\ nil)</span>     </h3>
<pre data-language="elixir">conn(String.Chars.t(), binary(), params()) :: Plug.Conn.t()</pre>  <p>Creates a test connection.</p> <p>The request <code class="inline">method</code> and <code class="inline">path</code> are required arguments. <code class="inline">method</code> may be any value that implements <a href="https://hexdocs.pm/elixir/Kernel.html#to_string/1" target="_blank"><code class="inline">to_string/1</code></a> and it will properly converted and normalized (e.g., <code class="inline">:get</code> or <code class="inline">"post"</code>).</p> <p>The <code class="inline">params_or_body</code> field must be one of:</p> <ul> <li>
<code class="inline">nil</code> - meaning there is no body; </li> <li>a binary - containing a request body. For such cases, <code class="inline">:headers</code> must be given as option with a content-type; </li> <li>a map or list - containing the parameters which will automatically set the content-type to multipart. The map or list may contain other lists or maps and all entries will be normalized to string keys; </li> </ul> <h4 id="conn/3-examples" class="section-heading">  Examples </h4> <pre data-language="elixir">conn(:get, "/foo?bar=10")
conn(:get, "/foo", %{bar: 10})
conn(:post, "/")
conn("patch", "/", "") |&gt; put_req_header("content-type", "application/json")</pre>    <h3 class="detail-header function" id="delete_req_cookie/2">  <span class="signature">delete_req_cookie(conn, key)</span>     </h3>
<pre data-language="elixir">delete_req_cookie(Plug.Conn.t(), binary()) :: Plug.Conn.t()</pre>  <p>Deletes a request cookie.</p>    <h3 class="detail-header function" id="init_test_session/2">  <span class="signature">init_test_session(conn, session)</span>     </h3>
<pre data-language="elixir">init_test_session(Plug.Conn.t(), %{optional(String.t() | atom()) =&gt; any()}) ::
  Plug.Conn.t()</pre>  <p>Initializes the session with the given contents.</p> <p>If the session has already been initialized, the new contents will be merged with the previous ones.</p>    <h3 class="detail-header function" id="put_http_protocol/2">  <span class="signature">put_http_protocol(conn, http_protocol)</span>  </h3>  <p>Puts the http protocol.</p>    <h3 class="detail-header function" id="put_peer_data/2">  <span class="signature">put_peer_data(conn, peer_data)</span>  </h3>  <p>Puts the peer data.</p>    <h3 class="detail-header function" id="put_req_cookie/3">  <span class="signature">put_req_cookie(conn, key, value)</span>     </h3>
<pre data-language="elixir">put_req_cookie(Plug.Conn.t(), binary(), binary()) :: Plug.Conn.t()</pre>  <p>Puts a request cookie.</p>    <h3 class="detail-header function" id="recycle_cookies/2">  <span class="signature">recycle_cookies(new_conn, old_conn)</span>     </h3>
<pre data-language="elixir">recycle_cookies(Plug.Conn.t(), Plug.Conn.t()) :: Plug.Conn.t()</pre>  <p>Moves cookies from a connection into a new connection for subsequent requests.</p> <p>This function copies the cookie information in <code class="inline">old_conn</code> into <code class="inline">new_conn</code>, emulating multiple requests done by clients where cookies are always passed forward, and returns the new version of <code class="inline">new_conn</code>.</p>    <h3 class="detail-header function" id="sent_informs/1">  <span class="signature">sent_informs(conn)</span>  </h3>  <p>Return the informational requests that have been sent.</p> <p>This function depends on gathering the messages sent by the test adapter when informational messages, such as an early hint, are sent. Calling this function will clear the informational request messages from the inbox for the process. To assert on multiple informs, the result of the function should be stored in a variable.</p> <h4 id="sent_informs/1-examples" class="section-heading">  Examples </h4> <pre data-language="elixir">conn = conn(:get, "/foo", "bar=10")
informs = Plug.Test.sent_informs(conn)
assert {"/static/application.css", [{"accept", "text/css"}]} in informs
assert {"/static/application.js", [{"accept", "application/javascript"}]} in informs</pre>    <h3 class="detail-header function" id="sent_pushes/1">  <span class="signature">sent_pushes(conn)</span>  </h3>  <p>Return the assets that have been pushed.</p> <p>This function depends on gathering the messages sent by the test adapter when assets are pushed. Calling this function will clear the pushed message from the inbox for the process. To assert on multiple pushes, the result of the function should be stored in a variable.</p> <h4 id="sent_pushes/1-examples" class="section-heading">  Examples </h4> <pre data-language="elixir">conn = conn(:get, "/foo?bar=10")
pushes = Plug.Test.sent_pushes(conn)
assert {"/static/application.css", [{"accept", "text/css"}]} in pushes
assert {"/static/application.js", [{"accept", "application/javascript"}]} in pushes</pre>    <h3 class="detail-header function" id="sent_resp/1">  <span class="signature">sent_resp(conn)</span>  </h3>  <p>Returns the sent response.</p> <p>This function is useful when the code being invoked crashes and there is a need to verify a particular response was sent even with the crash. It returns a tuple with <code class="inline">{status, headers, body}</code>.</p>
<div class="_attribution">
  <p class="_attribution-p">
    © 2013 Plataformatec<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://hexdocs.pm/plug/Plug.Test.html" class="_attribution-link" target="_blank">https://hexdocs.pm/plug/Plug.Test.html</a>
  </p>
</div>

				
			</div>
			<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
</amp-auto-ads>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
