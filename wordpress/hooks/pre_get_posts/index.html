
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Pre_get_posts - WordPress - W3cubDocs</title>
  
  <meta name="description" content=" Fires after the query variable object is created, but before the actual query is run. ">
  <meta name="keywords" content="do, action, ref, array, &#39;pre, get, posts&#39;, wp, query, &#36;this, pre, posts, -, wordpress">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/wordpress/hooks/pre_get_posts/">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" integrity="sha256-6/DH7X+2hvUPElJfGsvzm+tgIpmM9zjbYxnpsr6gR1A=" crossorigin="anonymous" href="/assets/application-ebf0c7ed7fb686f50f12525f1acbf39beb6022998cf738db6319e9b2bea04750.css">
  <script type="text/javascript" src="/assets/application-db285287b40ed28fac520fcfd75d7d874692b647b5b5e05968c741dda5de4148.js" integrity="sha256-2yhSh7QO0o+sUg/P1119h0aStke1teBZaMdB3aXeQUg=" crossorigin="anonymous"></script>
  <script src="/json/wordpress.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
        (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-2572770204602497",
            enable_page_level_ads: true
        });
  </script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/wordpress/" class="_nav-link" title="" style="margin-left:0;">WordPress</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _wordpress">
				
				
<h1>do_action_ref_array( 'pre_get_posts', WP_Query $this )</h1>  <section class="summary"> <p>Fires after the query variable object is created, but before the actual query is run.</p> </section> <div class="content-toc">  <section class="description"> <h2 class="toc-heading" id="description" tabindex="-1">Description </h2> <p>Note: If using conditional tags, use the method versions within the passed instance (e.g. $this-&gt;<a href="../../functions/is_main_query/">is_main_query()</a> instead of <a href="../../functions/is_main_query/">is_main_query()</a>). This is because the functions like <a href="../../functions/is_main_query/">is_main_query()</a> test against the global $wp_query instance, not the passed one.</p> </section>  <section class="parameters"> <h3 class="toc-heading" id="parameters" tabindex="-1">Parameters </h3> <dl> <dt>$this</dt> <dd> <p class="desc"> <span class="type">(<span class="WP_Query"><a href="../../classes/wp_query/">WP_Query</a></span>)</span> <span class="description">The <a href="../../classes/wp_query/">WP_Query</a> instance (passed by reference).</span> </p> </dd> </dl> </section>  <section class="source-content"> <h3 class="toc-heading" id="source" tabindex="-1">Source </h3> <p> File: <a href="https://developer.wordpress.org/reference/files/wp-includes/class-wp-query.php/" target="_blank">wp-includes/class-wp-query.php</a> </p> <p> <a href="https://core.trac.wordpress.org/browser/tags/5.2/src/wp-includes/class-wp-query.php#L1753" target="_blank">View on Trac</a> </p> </section>  <section class="changelog"> <h3 class="toc-heading" id="changelog" tabindex="-1">Changelog </h3> <table>  <thead> <tr> <th class="changelog-version">Version</th> <th class="changelog-desc">Description</th> </tr> </thead> <tbody> <tr> <td><a href="https://developer.wordpress.org/reference/since/2.0.0/" alt="WordPress 2.0.0" target="_blank">2.0.0</a></td> <td>Introduced.</td> </tr> </tbody> </table> </section>  <section class="explanation"> <h2 class="toc-heading" id="more-information" tabindex="-1">More Information </h2> <h3 class="toc-heading" id="targeting-the-right-query" tabindex="-1">
<span id="Identifying_Target_Queries" class="mw-headline">Targeting the right query</span> </h3> <p>Be aware of the queries you are changing when using the <code>pre_get_posts</code> action. Make use of <a href="https://developer.wordpress.org/themes/basics/conditional-tags/" target="_blank">conditional tags</a> to target the right query. For example, its recommended to use the the <a href="../../functions/is_admin/">is_admin()</a> conditional to <strong>not</strong> change queries in the admin screens. With the <code>$query-&gt;is_main_query()</code> conditional from the query object you can target the main query of a page request. The main query is used by the primary <a href="https://developer.wordpress.org/themes/basics/the-loop/" target="_blank">post loop</a> that displays the main content for a post, page or archive. Without these conditionals you could unintentionally be changing the query for custom loops in sidebars, footers, or elsewhere.</p> <p>Example targeting the main query for category archives:</p> <section class="source-content"> <pre class="source-code-container" data-language="php">add_action( 'pre_get_posts', 'target_main_category_query_with_conditional_tags' );

function target_main_category_query_with_conditional_tags( $query ) {

	if ( ! is_admin() &amp;&amp; $query-&gt;is_main_query() ) {
		// Not a query for an admin page.
		// It's the main query for a front end page of your site.

		if ( is_category() ) {
			// It's the main query for a category archive.

			// Let's change the query for category archives.
			$query-&gt;set( 'posts_per_page', 15 );
		}
	}
}</pre>  </section> <h3 class="toc-heading" id="default-main-query-arguments" tabindex="-1">Default main query arguments </h3> <p>The <em>main query</em> (object) already has some default properties set depending on the page request. For example, for single posts the <code>$query-&gt;is_single</code> property is set to true. This means you can’t simply change a <em>single post or page query</em> into an <em>archive of posts query</em> (or the other way around). To achieve this you’ll have to reset these properties in the query object itself. Unless you are intimately familiar with these settings and are willing to coordinate them yourself, it’s suggested that you replace the main query by using <a href="../../classes/wp_query/">WP_Query</a> in the page.php or single.php (child) <a href="https://developer.wordpress.org/themes/template-files-section/" target="_blank">theme template files</a>.</p> </section>  <section class="related"> <h2 class="toc-heading" id="related" tabindex="-1">Related </h2> <article class="used-by"> <h3 class="toc-heading" id="used-by" tabindex="-1">Used By </h3> <table id="used-by-table">  <thead> <tr> <th>Used By</th> <th class="related-desc">Description</th> </tr> </thead> <tbody> <tr> <td> <span>wp-includes/class-wp-query.php:</span> <a href="../../classes/wp_query/get_posts/">WP_Query::get_posts()</a> </td> <td class="related-desc"> <p>Retrieves an array of posts based on query variables.</p> </td> </tr> </tbody>

</table> </article> </section>   </div>
<div class="_attribution">
  <p class="_attribution-p">
    © 2003–2019 WordPress Foundation<br>Licensed under the GNU GPLv2+ License.<br>
    <a href="https://developer.wordpress.org/reference/hooks/pre_get_posts" class="_attribution-link" target="_blank">https://developer.wordpress.org/reference/hooks/pre_get_posts</a>
  </p>
</div>

				
			</div>
			<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
</amp-auto-ads>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
