
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Security Class - CodeIgniter 3 - W3cubDocs</title>
  
  <meta name="description" content=" The Security Class contains methods that help you create a secure application, processing input data for security. ">
  <meta name="keywords" content="security, class, -, codeigniter, codeigniter~3">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/codeigniter~3/libraries/security/">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" integrity="sha256-6/DH7X+2hvUPElJfGsvzm+tgIpmM9zjbYxnpsr6gR1A=" crossorigin="anonymous" href="/assets/application-ebf0c7ed7fb686f50f12525f1acbf39beb6022998cf738db6319e9b2bea04750.css">
  <script type="text/javascript" src="/assets/application-db285287b40ed28fac520fcfd75d7d874692b647b5b5e05968c741dda5de4148.js" integrity="sha256-2yhSh7QO0o+sUg/P1119h0aStke1teBZaMdB3aXeQUg=" crossorigin="anonymous"></script>
  <script src="/json/codeigniter~3.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
        (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-2572770204602497",
            enable_page_level_ads: true
        });
  </script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/codeigniter~3/" class="_nav-link" title="" style="margin-left:0;">CodeIgniter 3</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _sphinx">
				
				
<h1 id="security-class">Security Class</h1> <p>The Security Class contains methods that help you create a secure application, processing input data for security.</p>  <ul class="simple"> <li><a class="reference internal" href="#xss-filtering" id="id1">XSS Filtering</a></li> <li><a class="reference internal" href="#cross-site-request-forgery-csrf" id="id2">Cross-site request forgery (CSRF)</a></li> <li><a class="reference internal" href="#class-reference" id="id3">Class Reference</a></li> </ul>   <h2 id="xss-filtering">XSS Filtering</h2> <p>CodeIgniter comes with a Cross Site Scripting prevention filter, which looks for commonly used techniques to trigger JavaScript or other types of code that attempt to hijack cookies or do other malicious things. If anything disallowed is encountered it is rendered safe by converting the data to character entities.</p> <p>To filter data through the XSS filter use the <code>xss_clean()</code> method:</p> <pre data-language="php">$data = $this-&gt;security-&gt;xss_clean($data);
</pre> <p>An optional second parameter, <em>is_image</em>, allows this function to be used to test images for potential XSS attacks, useful for file upload security. When this second parameter is set to TRUE, instead of returning an altered string, the function returns TRUE if the image is safe, and FALSE if it contained potentially malicious information that a browser may attempt to execute.</p> <pre data-language="php">if ($this-&gt;security-&gt;xss_clean($file, TRUE) === FALSE)
{
        // file failed the XSS test
}
</pre> <div class="admonition important"> <p class="first admonition-title">Important</p> <p class="last">If you want to filter HTML attribute values, use <a class="reference internal" href="../../general/common_functions/#html_escape" title="html_escape"><code>html_escape()</code></a> instead!</p> </div>   <h2 id="cross-site-request-forgery-csrf">Cross-site request forgery (CSRF)</h2> <p>You can enable CSRF protection by altering your <strong>application/config/config.php</strong> file in the following way:</p> <pre data-language="php">$config['csrf_protection'] = TRUE;
</pre> <p>If you use the <a class="reference internal" href="../../helpers/form_helper/"><span class="doc">form helper</span></a>, then <code>form_open()</code> will automatically insert a hidden csrf field in your forms. If not, then you can use <code>get_csrf_token_name()</code> and <code>get_csrf_hash()</code></p> <pre data-language="php">$csrf = array(
        'name' =&gt; $this-&gt;security-&gt;get_csrf_token_name(),
        'hash' =&gt; $this-&gt;security-&gt;get_csrf_hash()
);

...

&lt;input type="hidden" name="&lt;?=$csrf['name'];?&gt;" value="&lt;?=$csrf['hash'];?&gt;" /&gt;
</pre> <p>Tokens may be either regenerated on every submission (default) or kept the same throughout the life of the CSRF cookie. The default regeneration of tokens provides stricter security, but may result in usability concerns as other tokens become invalid (back/forward navigation, multiple tabs/windows, asynchronous actions, etc). You may alter this behavior by editing the following config parameter</p> <pre data-language="php">$config['csrf_regenerate'] = TRUE;
</pre> <p>Select URIs can be whitelisted from csrf protection (for example API endpoints expecting externally POSTed content). You can add these URIs by editing the ‘csrf_exclude_uris’ config parameter:</p> <pre data-language="php">$config['csrf_exclude_uris'] = array('api/person/add');
</pre> <p>Regular expressions are also supported (case-insensitive):</p> <pre data-language="php">$config['csrf_exclude_uris'] = array(
        'api/record/[0-9]+',
        'api/title/[a-z]+'
);
</pre>   <h2 id="class-reference">Class Reference</h2> <dl class="class"> <dt id="CI_Security">
<code>class CI_Security</code> </dt> <dd>
<dl class="method"> <dt id="CI_Security::xss_clean">
<code>xss_clean($str[, $is_image = FALSE])</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Parameters:</th>
<td class="field-body">
<ul class="first simple"> <li>
<strong>$str</strong> (<em>mixed</em>) – Input string or an array of strings</li> </ul> </td> </tr> <tr>
<th class="field-name">Returns:</th>
<td class="field-body">
<p class="first">XSS-clean data</p> </td> </tr> <tr>
<th class="field-name">Return type:</th>
<td class="field-body">
<p class="first last">mixed</p> </td> </tr>  </table> <p>Tries to remove XSS exploits from the input data and returns the cleaned string. If the optional second parameter is set to true, it will return boolean TRUE if the image is safe to use and FALSE if malicious data was detected in it.</p> <div class="admonition important"> <p class="first admonition-title">Important</p> <p class="last">This method is not suitable for filtering HTML attribute values! Use <a class="reference internal" href="../../general/common_functions/#html_escape" title="html_escape"><code>html_escape()</code></a> for that instead.</p> </div> </dd>
</dl> <dl class="method"> <dt id="CI_Security::sanitize_filename">
<code>sanitize_filename($str[, $relative_path = FALSE])</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Parameters:</th>
<td class="field-body">
<ul class="first simple"> <li>
<strong>$str</strong> (<em>string</em>) – File name/path</li> <li>
<strong>$relative_path</strong> (<em>bool</em>) – Whether to preserve any directories in the file path</li> </ul> </td> </tr> <tr>
<th class="field-name">Returns:</th>
<td class="field-body">
<p class="first">Sanitized file name/path</p> </td> </tr> <tr>
<th class="field-name">Return type:</th>
<td class="field-body">
<p class="first last">string</p> </td> </tr>  </table> <p>Tries to sanitize filenames in order to prevent directory traversal attempts and other security threats, which is particularly useful for files that were supplied via user input.</p> <pre data-language="php">$filename = $this-&gt;security-&gt;sanitize_filename($this-&gt;input-&gt;post('filename'));
</pre> <p>If it is acceptable for the user input to include relative paths, e.g. <em>file/in/some/approved/folder.txt</em>, you can set the second optional parameter, <code>$relative_path</code> to TRUE.</p> <pre data-language="php">$filename = $this-&gt;security-&gt;sanitize_filename($this-&gt;input-&gt;post('filename'), TRUE);
</pre> </dd>
</dl> <dl class="method"> <dt id="CI_Security::get_csrf_token_name">
<code>get_csrf_token_name()</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Returns:</th>
<td class="field-body">CSRF token name</td> </tr> <tr>
<th class="field-name">Return type:</th>
<td class="field-body">string</td> </tr>  </table> <p>Returns the CSRF token name (the <code>$config['csrf_token_name']</code> value).</p> </dd>
</dl> <dl class="method"> <dt id="CI_Security::get_csrf_hash">
<code>get_csrf_hash()</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Returns:</th>
<td class="field-body">CSRF hash</td> </tr> <tr>
<th class="field-name">Return type:</th>
<td class="field-body">string</td> </tr>  </table> <p>Returns the CSRF hash value. Useful in combination with <code>get_csrf_token_name()</code> for manually building forms or sending valid AJAX POST requests.</p> </dd>
</dl> <dl class="method"> <dt id="CI_Security::entity_decode">
<code>entity_decode($str[, $charset = NULL])</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Parameters:</th>
<td class="field-body">
<ul class="first simple"> <li>
<strong>$str</strong> (<em>string</em>) – Input string</li> <li>
<strong>$charset</strong> (<em>string</em>) – Character set of the input string</li> </ul> </td> </tr> <tr>
<th class="field-name">Returns:</th>
<td class="field-body">
<p class="first">Entity-decoded string</p> </td> </tr> <tr>
<th class="field-name">Return type:</th>
<td class="field-body">
<p class="first last">string</p> </td> </tr>  </table> <p>This method acts a lot like PHP’s own native <code>html_entity_decode()</code> function in ENT_COMPAT mode, only it tries to detect HTML entities that don’t end in a semicolon because some browsers allow that.</p> <p>If the <code>$charset</code> parameter is left empty, then your configured <code>$config['charset']</code> value will be used.</p> </dd>
</dl> <dl class="method"> <dt id="CI_Security::get_random_bytes">
<code>get_random_bytes($length)</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Parameters:</th>
<td class="field-body">
<ul class="first simple"> <li>
<strong>$length</strong> (<em>int</em>) – Output length</li> </ul> </td> </tr> <tr>
<th class="field-name">Returns:</th>
<td class="field-body">
<p class="first">A binary stream of random bytes or FALSE on failure</p> </td> </tr> <tr>
<th class="field-name">Return type:</th>
<td class="field-body">
<p class="first last">string</p> </td> </tr>  </table> <p>A convenience method for getting proper random bytes via <code>mcrypt_create_iv()</code>, <code>/dev/urandom</code> or <code>openssl_random_pseudo_bytes()</code> (in that order), if one of them is available.</p> <p>Used for generating CSRF and XSS tokens.</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">The output is NOT guaranteed to be cryptographically secure, just the best attempt at that.</p> </div> </dd>
</dl> </dd>
</dl>
<div class="_attribution">
  <p class="_attribution-p">
    © 2014–2018 British Columbia Institute of Technology<br>Licensed under the MIT License.<br>
    <a href="https://www.codeigniter.com/user_guide/libraries/security.html" class="_attribution-link" target="_blank">https://www.codeigniter.com/user_guide/libraries/security.html</a>
  </p>
</div>

				
			</div>
			<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
</amp-auto-ads>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
