
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>File Uploading Class - CodeIgniter 3 - W3cubDocs</title>
  
  <meta name="description" content=" CodeIgniter’s File Uploading Class permits files to be uploaded. You can set various preferences, restricting the type and size of the files. ">
  <meta name="keywords" content="file, uploading, class, -, codeigniter, codeigniter~3">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/codeigniter~3/libraries/file_uploading/">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" integrity="sha256-6/DH7X+2hvUPElJfGsvzm+tgIpmM9zjbYxnpsr6gR1A=" crossorigin="anonymous" href="/assets/application-ebf0c7ed7fb686f50f12525f1acbf39beb6022998cf738db6319e9b2bea04750.css">
  <script type="text/javascript" src="/assets/application-db285287b40ed28fac520fcfd75d7d874692b647b5b5e05968c741dda5de4148.js" integrity="sha256-2yhSh7QO0o+sUg/P1119h0aStke1teBZaMdB3aXeQUg=" crossorigin="anonymous"></script>
  <script src="/json/codeigniter~3.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
        (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-2572770204602497",
            enable_page_level_ads: true
        });
  </script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/codeigniter~3/" class="_nav-link" title="" style="margin-left:0;">CodeIgniter 3</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _sphinx">
				
				
<h1 id="file-uploading-class">File Uploading Class</h1> <p>CodeIgniter’s File Uploading Class permits files to be uploaded. You can set various preferences, restricting the type and size of the files.</p>  <ul class="simple"> <li>
<a class="reference internal" href="#the-process" id="id1">The Process</a><ul> <li><a class="reference internal" href="#creating-the-upload-form" id="id2">Creating the Upload Form</a></li> <li><a class="reference internal" href="#the-success-page" id="id3">The Success Page</a></li> <li><a class="reference internal" href="#the-controller" id="id4">The Controller</a></li> <li><a class="reference internal" href="#the-upload-directory" id="id5">The Upload Directory</a></li> <li><a class="reference internal" href="#try-it" id="id6">Try it!</a></li> </ul> </li> <li>
<a class="reference internal" href="#reference-guide" id="id7">Reference Guide</a><ul> <li><a class="reference internal" href="#initializing-the-upload-class" id="id8">Initializing the Upload Class</a></li> <li><a class="reference internal" href="#setting-preferences" id="id9">Setting Preferences</a></li> <li><a class="reference internal" href="#preferences" id="id10">Preferences</a></li> <li><a class="reference internal" href="#setting-preferences-in-a-config-file" id="id11">Setting preferences in a config file</a></li> </ul> </li> <li><a class="reference internal" href="#class-reference" id="id12">Class Reference</a></li> </ul>   <h2 id="the-process">The Process</h2> <p>Uploading a file involves the following general process:</p> <ul class="simple"> <li>An upload form is displayed, allowing a user to select a file and upload it.</li> <li>When the form is submitted, the file is uploaded to the destination you specify.</li> <li>Along the way, the file is validated to make sure it is allowed to be uploaded based on the preferences you set.</li> <li>Once uploaded, the user will be shown a success message.</li> </ul> <p>To demonstrate this process here is brief tutorial. Afterward you’ll find reference information.</p>  <h3 id="creating-the-upload-form">Creating the Upload Form</h3> <p>Using a text editor, create a form called upload_form.php. In it, place this code and save it to your <strong>application/views/</strong> directory:</p> <pre data-language="php">&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Upload Form&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;?php echo $error;?&gt;

&lt;?php echo form_open_multipart('upload/do_upload');?&gt;

&lt;input type="file" name="userfile" size="20" /&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;input type="submit" value="upload" /&gt;

&lt;/form&gt;

&lt;/body&gt;
&lt;/html&gt;
</pre> <p>You’ll notice we are using a form helper to create the opening form tag. File uploads require a multipart form, so the helper creates the proper syntax for you. You’ll also notice we have an $error variable. This is so we can show error messages in the event the user does something wrong.</p>   <h3 id="the-success-page">The Success Page</h3> <p>Using a text editor, create a form called upload_success.php. In it, place this code and save it to your <strong>application/views/</strong> directory:</p> <pre data-language="php">&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Upload Form&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;h3&gt;Your file was successfully uploaded!&lt;/h3&gt;

&lt;ul&gt;
&lt;?php foreach ($upload_data as $item =&gt; $value):?&gt;
&lt;li&gt;&lt;?php echo $item;?&gt;: &lt;?php echo $value;?&gt;&lt;/li&gt;
&lt;?php endforeach; ?&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;?php echo anchor('upload', 'Upload Another File!'); ?&gt;&lt;/p&gt;

&lt;/body&gt;
&lt;/html&gt;
</pre>   <h3 id="the-controller">The Controller</h3> <p>Using a text editor, create a controller called Upload.php. In it, place this code and save it to your <strong>application/controllers/</strong> directory:</p> <pre data-language="php">&lt;?php

class Upload extends CI_Controller {

        public function __construct()
        {
                parent::__construct();
                $this-&gt;load-&gt;helper(array('form', 'url'));
        }

        public function index()
        {
                $this-&gt;load-&gt;view('upload_form', array('error' =&gt; ' ' ));
        }

        public function do_upload()
        {
                $config['upload_path']          = './uploads/';
                $config['allowed_types']        = 'gif|jpg|png';
                $config['max_size']             = 100;
                $config['max_width']            = 1024;
                $config['max_height']           = 768;

                $this-&gt;load-&gt;library('upload', $config);

                if ( ! $this-&gt;upload-&gt;do_upload('userfile'))
                {
                        $error = array('error' =&gt; $this-&gt;upload-&gt;display_errors());

                        $this-&gt;load-&gt;view('upload_form', $error);
                }
                else
                {
                        $data = array('upload_data' =&gt; $this-&gt;upload-&gt;data());

                        $this-&gt;load-&gt;view('upload_success', $data);
                }
        }
}
?&gt;
</pre>   <h3 id="the-upload-directory">The Upload Directory</h3> <p>You’ll need a destination directory for your uploaded images. Create a directory at the root of your CodeIgniter installation called uploads and set its file permissions to 777.</p>   <h3 id="try-it">Try it!</h3> <p>To try your form, visit your site using a URL similar to this one:</p> <pre data-language="php">example.com/index.php/upload/
</pre> <p>You should see an upload form. Try uploading an image file (either a jpg, gif, or png). If the path in your controller is correct it should work.</p>    <h2 id="reference-guide">Reference Guide</h2>  <h3 id="initializing-the-upload-class">Initializing the Upload Class</h3> <p>Like most other classes in CodeIgniter, the Upload class is initialized in your controller using the <code>$this-&gt;load-&gt;library()</code> method:</p> <pre data-language="php">$this-&gt;load-&gt;library('upload');
</pre> <p>Once the Upload class is loaded, the object will be available using: $this-&gt;upload</p>   <h3 id="setting-preferences">Setting Preferences</h3> <p>Similar to other libraries, you’ll control what is allowed to be upload based on your preferences. In the controller you built above you set the following preferences:</p> <pre data-language="php">$config['upload_path'] = './uploads/';
$config['allowed_types'] = 'gif|jpg|png';
$config['max_size']     = '100';
$config['max_width'] = '1024';
$config['max_height'] = '768';

$this-&gt;load-&gt;library('upload', $config);

// Alternately you can set preferences by calling the ``initialize()`` method. Useful if you auto-load the class:
$this-&gt;upload-&gt;initialize($config);
</pre> <p>The above preferences should be fairly self-explanatory. Below is a table describing all available preferences.</p>   <h3 id="preferences">Preferences</h3> <p>The following preferences are available. The default value indicates what will be used if you do not specify that preference.</p> <table class="docutils">  <thead valign="bottom"> <tr>
<th class="head">Preference</th> <th class="head">Default Value</th> <th class="head">Options</th> <th class="head">Description</th> </tr> </thead>  <tr>
<td><strong>upload_path</strong></td> <td>None</td> <td>None</td> <td>The path to the directory where the upload should be placed. The directory must be writable and the path can be absolute or relative.</td> </tr> <tr>
<td><strong>allowed_types</strong></td> <td>None</td> <td>None</td> <td>The mime types corresponding to the types of files you allow to be uploaded. Usually the file extension can be used as the mime type. Can be either an array or a pipe-separated string.</td> </tr> <tr>
<td><strong>file_name</strong></td> <td>None</td> <td>Desired file name</td> <td>If set CodeIgniter will rename the uploaded file to this name. The extension provided in the file name must also be an allowed file type. If no extension is provided in the original file_name will be used.</td> </tr> <tr>
<td><strong>file_ext_tolower</strong></td> <td>FALSE</td> <td>TRUE/FALSE (boolean)</td> <td>If set to TRUE, the file extension will be forced to lower case</td> </tr> <tr>
<td><strong>overwrite</strong></td> <td>FALSE</td> <td>TRUE/FALSE (boolean)</td> <td>If set to true, if a file with the same name as the one you are uploading exists, it will be overwritten. If set to false, a number will be appended to the filename if another with the same name exists.</td> </tr> <tr>
<td><strong>max_size</strong></td> <td>0</td> <td>None</td> <td>The maximum size (in kilobytes) that the file can be. Set to zero for no limit. Note: Most PHP installations have their own limit, as specified in the php.ini file. Usually 2 MB (or 2048 KB) by default.</td> </tr> <tr>
<td><strong>max_width</strong></td> <td>0</td> <td>None</td> <td>The maximum width (in pixels) that the image can be. Set to zero for no limit.</td> </tr> <tr>
<td><strong>max_height</strong></td> <td>0</td> <td>None</td> <td>The maximum height (in pixels) that the image can be. Set to zero for no limit.</td> </tr> <tr>
<td><strong>min_width</strong></td> <td>0</td> <td>None</td> <td>The minimum width (in pixels) that the image can be. Set to zero for no limit.</td> </tr> <tr>
<td><strong>min_height</strong></td> <td>0</td> <td>None</td> <td>The minimum height (in pixels) that the image can be. Set to zero for no limit.</td> </tr> <tr>
<td><strong>max_filename</strong></td> <td>0</td> <td>None</td> <td>The maximum length that a file name can be. Set to zero for no limit.</td> </tr> <tr>
<td><strong>max_filename_increment</strong></td> <td>100</td> <td>None</td> <td>When overwrite is set to FALSE, use this to set the maximum filename increment for CodeIgniter to append to the filename.</td> </tr> <tr>
<td><strong>encrypt_name</strong></td> <td>FALSE</td> <td>TRUE/FALSE (boolean)</td> <td>If set to TRUE the file name will be converted to a random encrypted string. This can be useful if you would like the file saved with a name that can not be discerned by the person uploading it.</td> </tr> <tr>
<td><strong>remove_spaces</strong></td> <td>TRUE</td> <td>TRUE/FALSE (boolean)</td> <td>If set to TRUE, any spaces in the file name will be converted to underscores. This is recommended.</td> </tr> <tr>
<td><strong>detect_mime</strong></td> <td>TRUE</td> <td>TRUE/FALSE (boolean)</td> <td>If set to TRUE, a server side detection of the file type will be performed to avoid code injection attacks. DO NOT disable this option unless you have no other option as that would cause a security risk.</td> </tr> <tr>
<td><strong>mod_mime_fix</strong></td> <td>TRUE</td> <td>TRUE/FALSE (boolean)</td> <td>If set to TRUE, multiple filename extensions will be suffixed with an underscore in order to avoid triggering <a class="reference external" href="http://httpd.apache.org/docs/2.0/mod/mod_mime.html#multipleext" target="_blank">Apache mod_mime</a>. DO NOT turn off this option if your upload directory is public, as this is a security risk.</td> </tr>  </table>   <h3 id="setting-preferences-in-a-config-file">Setting preferences in a config file</h3> <p>If you prefer not to set preferences using the above method, you can instead put them into a config file. Simply create a new file called the upload.php, add the $config array in that file. Then save the file in: <strong>config/upload.php</strong> and it will be used automatically. You will NOT need to use the <code>$this-&gt;upload-&gt;initialize()</code> method if you save your preferences in a config file.</p>    <h2 id="class-reference">Class Reference</h2> <dl class="class"> <dt id="CI_Upload">
<code>class CI_Upload</code> </dt> <dd>
<dl class="method"> <dt id="CI_Upload::initialize">
<code>initialize([array $config = array()[, $reset = TRUE]])</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Parameters:</th>
<td class="field-body">
<ul class="first simple"> <li>
<strong>$config</strong> (<em>array</em>) – Preferences</li> <li>
<strong>$reset</strong> (<em>bool</em>) – Whether to reset preferences (that are not provided in $config) to their defaults</li> </ul> </td> </tr> <tr>
<th class="field-name">Returns:</th>
<td class="field-body">
<p class="first">CI_Upload instance (method chaining)</p> </td> </tr> <tr>
<th class="field-name">Return type:</th>
<td class="field-body">
<p class="first last">CI_Upload</p> </td> </tr>  </table> </dd>
</dl> <dl class="method"> <dt id="CI_Upload::do_upload">
<code>do_upload([$field = 'userfile'])</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Parameters:</th>
<td class="field-body">
<ul class="first simple"> <li>
<strong>$field</strong> (<em>string</em>) – Name of the form field</li> </ul> </td> </tr> <tr>
<th class="field-name">Returns:</th>
<td class="field-body">
<p class="first">TRUE on success, FALSE on failure</p> </td> </tr> <tr>
<th class="field-name">Return type:</th>
<td class="field-body">
<p class="first last">bool</p> </td> </tr>  </table> <p>Performs the upload based on the preferences you’ve set.</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">By default the upload routine expects the file to come from a form field called userfile, and the form must be of type “multipart”.</p> </div> <pre data-language="php">&lt;form method="post" action="some_action" enctype="multipart/form-data" /&gt;
</pre> <p>If you would like to set your own field name simply pass its value to the <code>do_upload()</code> method:</p> <pre data-language="php">$field_name = "some_field_name";
$this-&gt;upload-&gt;do_upload($field_name);
</pre> </dd>
</dl> <dl class="method"> <dt id="CI_Upload::display_errors">
<code>display_errors([$open = '&lt;p&gt;'[, $close = '&lt;/p&gt;']])</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Parameters:</th>
<td class="field-body">
<ul class="first simple"> <li>
<strong>$open</strong> (<em>string</em>) – Opening markup</li> <li>
<strong>$close</strong> (<em>string</em>) – Closing markup</li> </ul> </td> </tr> <tr>
<th class="field-name">Returns:</th>
<td class="field-body">
<p class="first">Formatted error message(s)</p> </td> </tr> <tr>
<th class="field-name">Return type:</th>
<td class="field-body">
<p class="first last">string</p> </td> </tr>  </table> <p>Retrieves any error messages if the <code>do_upload()</code> method returned false. The method does not echo automatically, it returns the data so you can assign it however you need.</p> <p><strong>Formatting Errors</strong></p>  <p>By default the above method wraps any errors within &lt;p&gt; tags. You can set your own delimiters like this:</p> <pre data-language="php">$this-&gt;upload-&gt;display_errors('&lt;p&gt;', '&lt;/p&gt;');
</pre>  </dd>
</dl> <dl class="method"> <dt id="CI_Upload::data">
<code>data([$index = NULL])</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Parameters:</th>
<td class="field-body">
<ul class="first simple"> <li>
<strong>$data</strong> (<em>string</em>) – Element to return instead of the full array</li> </ul> </td> </tr> <tr>
<th class="field-name">Returns:</th>
<td class="field-body">
<p class="first">Information about the uploaded file</p> </td> </tr> <tr>
<th class="field-name">Return type:</th>
<td class="field-body">
<p class="first last">mixed</p> </td> </tr>  </table> <p>This is a helper method that returns an array containing all of the data related to the file you uploaded. Here is the array prototype:</p> <pre data-language="php">Array
(
        [file_name]     =&gt; mypic.jpg
        [file_type]     =&gt; image/jpeg
        [file_path]     =&gt; /path/to/your/upload/
        [full_path]     =&gt; /path/to/your/upload/jpg.jpg
        [raw_name]      =&gt; mypic
        [orig_name]     =&gt; mypic.jpg
        [client_name]   =&gt; mypic.jpg
        [file_ext]      =&gt; .jpg
        [file_size]     =&gt; 22.2
        [is_image]      =&gt; 1
        [image_width]   =&gt; 800
        [image_height]  =&gt; 600
        [image_type]    =&gt; jpeg
        [image_size_str] =&gt; width="800" height="200"
)
</pre> <p>To return one element from the array:</p> <pre data-language="php">$this-&gt;upload-&gt;data('file_name');       // Returns: mypic.jpg
</pre> <p>Here’s a table explaining the above-displayed array items:</p> <table class="docutils">  <thead valign="bottom"> <tr>
<th class="head">Item</th> <th class="head">Description</th> </tr> </thead>  <tr>
<td>file_name</td> <td>Name of the file that was uploaded, including the filename extension</td> </tr> <tr>
<td>file_type</td> <td>File MIME type identifier</td> </tr> <tr>
<td>file_path</td> <td>Absolute server path to the file</td> </tr> <tr>
<td>full_path</td> <td>Absolute server path, including the file name</td> </tr> <tr>
<td>raw_name</td> <td>File name, without the extension</td> </tr> <tr>
<td>orig_name</td> <td>Original file name. This is only useful if you use the encrypted name option.</td> </tr> <tr>
<td>client_name</td> <td>File name as supplied by the client user agent, prior to any file name preparation or incrementing</td> </tr> <tr>
<td>file_ext</td> <td>Filename extension, period included</td> </tr> <tr>
<td>file_size</td> <td>File size in kilobytes</td> </tr> <tr>
<td>is_image</td> <td>Whether the file is an image or not. 1 = image. 0 = not.</td> </tr> <tr>
<td>image_width</td> <td>Image width</td> </tr> <tr>
<td>image_height</td> <td>Image height</td> </tr> <tr>
<td>image_type</td> <td>Image type (usually the file name extension without the period)</td> </tr> <tr>
<td>image_size_str</td> <td>A string containing the width and height (useful to put into an image tag)</td> </tr>  </table> </dd>
</dl> </dd>
</dl>
<div class="_attribution">
  <p class="_attribution-p">
    © 2014–2018 British Columbia Institute of Technology<br>Licensed under the MIT License.<br>
    <a href="https://www.codeigniter.com/user_guide/libraries/file_uploading.html" class="_attribution-link" target="_blank">https://www.codeigniter.com/user_guide/libraries/file_uploading.html</a>
  </p>
</div>

				
			</div>
			<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
</amp-auto-ads>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
