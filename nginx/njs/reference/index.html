
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Reference - Nginx - W3cubDocs</title>
  
  <meta name="description" content=" njs provides objects, methods and properties for extending nginx functionality. ">
  <meta name="keywords" content="reference, -, nginx">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/nginx/njs/reference/">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" integrity="sha256-6/DH7X+2hvUPElJfGsvzm+tgIpmM9zjbYxnpsr6gR1A=" crossorigin="anonymous" href="/assets/application-ebf0c7ed7fb686f50f12525f1acbf39beb6022998cf738db6319e9b2bea04750.css">
  <script type="text/javascript" src="/assets/application-db285287b40ed28fac520fcfd75d7d874692b647b5b5e05968c741dda5de4148.js" integrity="sha256-2yhSh7QO0o+sUg/P1119h0aStke1teBZaMdB3aXeQUg=" crossorigin="anonymous"></script>
  <script src="/json/nginx.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
        (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-2572770204602497",
            enable_page_level_ads: true
        });
  </script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/nginx/" class="_nav-link" title="" style="margin-left:0;">nginx</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _nginx">
				
				
<h1>Reference</h1>
<ul>
<li><a href="#http_stream">nginx objects</a></li>
<li><a href="#http">HTTP Request</a></li>
<li><a href="#stream">Stream Session</a></li>
<li><a href="#core">Core</a></li>
<li><a href="#core_global">Global</a></li>
<li><a href="#core_object">Object</a></li>
<li><a href="#string">String</a></li>
<li><a href="#core_json">JSON</a></li>
<li><a href="#crypto">Crypto</a></li>
<li><a href="#njs_api_timers">Timers</a></li>
<li><a href="#njs_api_fs">File System</a></li>
</ul>
<p id="summary"> <a href="../">njs</a> provides objects, methods and properties for extending nginx functionality. </p>
<h4 id="http_stream">nginx objects</h4>
<h4 id="http">HTTP Request</h4>
<p> The HTTP request object is available only in the <a href="../../http/ngx_http_js_module/">ngx_http_js_module</a> module. All string properties of the object are <a href="#string">byte strings</a>. </p> <dl class="compact"> <dt id="r_args"><code>r.args{}</code></dt> <dd> request arguments object, read-only </dd> <dt><code>r.error(<i>string</i>)</code></dt> <dd> writes a <code>string</code> to the error log on the <code>error</code> level of logging </dd> <dt><code>r.finish()</code></dt> <dd> finishes sending a response to the client </dd> <dt id="r_headers_in"><code>r.headersIn{}</code></dt> <dd> incoming headers object, read-only. <p> For example, the <code>Foo</code> header can be accessed with the syntax <code>headersIn.foo</code> or <code>headersIn['Foo']</code> </p> </dd> <dt id="r_headers_out"><code>r.headersOut{}</code></dt> <dd> outgoing headers object, writable. <p> For example, the <code>Foo</code> header can be accessed with the syntax <code>headersOut.foo</code> or <code>headersOut['Foo']</code> </p> </dd> <dt><code>r.httpVersion</code></dt> <dd> HTTP version, read-only </dd> <dt><code>r.log(<i>string</i>)</code></dt> <dd> writes a <code>string</code> to the error log on the <code>info</code> level of logging </dd> <dt id="r_internal_redirect"><code>r.internalRedirect(<i>uri</i>)</code></dt> <dd> performs an internal redirect to the specified <code>uri</code>. If the uri starts with the “<code>@</code>” prefix, it is considered a named location. </dd> <dt><code>r.method</code></dt> <dd> HTTP method, read-only </dd> <dt><code>r.parent</code></dt> <dd> references the parent request object </dd> <dt><code>r.remoteAddress</code></dt> <dd> client address, read-only </dd> <dt id="r_request_body"><code>r.requestBody</code></dt> <dd> returns the client request body if it has not been written to a temporary file. To ensure that the client request body is in memory, its size should be limited by <a href="../../http/ngx_http_core_module/#client_max_body_size">client_max_body_size</a>, and a sufficient buffer size should be set using <a href="../../http/ngx_http_core_module/#client_body_buffer_size">client_body_buffer_size</a>. The property is available only in the <a href="../../http/ngx_http_js_module/#js_content">js_content</a> directive. </dd> <dt id="r_response_body"><code>r.responseBody</code></dt> <dd> holds the <a href="#subrequest">subrequest</a> response body, read-only. The size of <code>r.responseBody</code> is limited by the <a href="../../http/ngx_http_core_module/#subrequest_output_buffer_size">subrequest_output_buffer_size</a> directive. </dd> <dt><code>r.return(status[, string])</code></dt> <dd> sends the entire response with the specified <code>status</code> to the client <p> It is possible to specify either a redirect URL (for codes 301, 302, 303, 307, and 308) or the response body text (for other codes) as the second argument </p> </dd> <dt><code>r.send(<i>string</i>)</code></dt> <dd> sends a part of the response body to the client </dd> <dt><code>r.sendHeader()</code></dt> <dd> sends the HTTP headers to the client </dd> <dt><code>r.status</code></dt> <dd> status, writable </dd> <dt id="r_variables"><code>r.variables{}</code></dt> <dd> nginx variables object, writable (since <a href="../changes/#njs0.2.8">0.2.8</a>) </dd> <dt><code>r.warn(<i>string</i>)</code></dt> <dd> writes a <code>string</code> to the error log on the <code>warning</code> level of logging </dd> <dt id="r_uri"><code>r.uri</code></dt> <dd> current <a href="../../http/ngx_http_core_module/#var_uri">URI</a> in request, <a href="../../http/ngx_http_core_module/#location">normalized</a>, read-only </dd> <dt id="subrequest"><code>r.subrequest(<i>uri</i>[,
<i>options</i>[, <i>callback</i>]])</code></dt> <dd> creates a subrequest with the given <code>uri</code> and <code>options</code>, and installs an optional completion <code>callback</code>. <p> A <a href="../../dev/development_guide/#http_subrequests">subrequest</a> shares its input headers with the client request. To send headers different from original headers to a proxied server, the <a href="../../http/ngx_http_proxy_module/#proxy_set_header">proxy_set_header</a> directive can be used. To send a completely new set of headers to a proxied server, the <a href="../../http/ngx_http_proxy_module/#proxy_pass_request_headers">proxy_pass_request_headers</a> directive can be used. </p> <p> If <code>options</code> is a string, then it holds the subrequest arguments string. Otherwise, <code>options</code> is expected to be an object with the following keys: </p> <dl class="compact"> <dt><code>args</code></dt> <dd> arguments string, by default an empty string is used </dd> <dt><code>body</code></dt> <dd> request body, by default the request body of the parent request object is used </dd> <dt><code>method</code></dt> <dd> HTTP method, by default the <code>GET</code> method is used </dd> </dl>
 <p> The completion <code>callback</code> receives a subrequest response object with methods and properties identical to the parent request object. </p> </dd> </dl>

<h4 id="stream">Stream Session</h4>
<p> The stream session object is available only in the <a href="../../stream/ngx_stream_js_module/">ngx_stream_js_module</a> module. All string properties of the object are <a href="#string">byte strings</a>. </p>
 <dl class="compact"> <dt id="s_allow"><code>s.allow()</code></dt> <dd> successfully finalizes the phase handler (<a href="../changes/#njs0.2.4">0.2.4</a>) </dd> <dt id="s_decline"><code>s.decline()</code></dt> <dd> finalizes the phase handler and passes control to the next handler (<a href="../changes/#njs0.2.4">0.2.4</a>) </dd> <dt id="s_deny"><code>s.deny()</code></dt> <dd> finalizes the phase handler with the access error code (<a href="../changes/#njs0.2.4">0.2.4</a>) </dd> <dt id="s_done">
<code>s.done</code>(<code><i>[code]</i></code>)</dt> <dd> successfully finalizes the current phase handler or finalizes it with the specified numeric code (<a href="../changes/#njs0.2.4">0.2.4</a>). </dd> <dt><code>s.error(<i>string</i>)</code></dt> <dd> writes a sent <code>string</code> to the error log on the <code>error</code> level of logging </dd> <dt><code>s.log(<i>string</i>)</code></dt> <dd> writes a sent <code><i>string</i></code> to the error log on the <code>info</code> level of logging </dd> <dt id="s_off"><code>s.off(<i>eventName</i>)</code></dt> <dd> unregisters the callback set by the <a href="#s_on">s.on()</a> method (<a href="../changes/#njs0.2.4">0.2.4</a>) </dd> <dt id="s_on"><code>s.on(<i>event</i>,
<i>callback</i>)</code></dt> <dd> registers a <code>callback</code> for the specified <code>event</code> (<a href="../changes/#njs0.2.4">0.2.4</a>). <p> An <code>event</code> may be one of the following strings: </p> <dl class="compact"> <dt><code>upload</code></dt> <dd> new data from a client </dd> <dt><code>download</code></dt> <dd> new data to a client </dd> </dl>
 <p> The completion callback has the following prototype: <code>callback(data, flags)</code>, where <code>data</code> is string, <code>flags</code> is an object with the following properties: </p> <dl class="compact"> <dt id="s_on_callback_last"><code>last</code></dt> <dd> a boolean value, true if data is a last buffer. </dd> </dl>
 </dd> <dt><code>s.remoteAddress</code></dt> <dd> client address, read-only </dd> <dt id="s_send"><code>s.send(<i>data</i>[,
<i>options</i>])</code></dt> <dd> sends the data to the client (<a href="../changes/#njs0.2.4">0.2.4</a>). The <code>options</code> is an object used to override nginx buffer flags derived from an incoming data chunk buffer. The flags can be overriden with the following flags:  <dl class="compact"> <dt><code>last</code></dt> <dd> boolean, true if the buffer is the last buffer </dd> <dt><code>flush</code></dt> <dd> boolean, true if the buffer should have the <code>flush</code> flag </dd> </dl>
 The method can be called multiple times per callback invocation. </dd> <dt id="s_variables"><code>s.variables{}</code></dt> <dd> nginx variables object, writable (since <a href="../changes/#njs0.2.8">0.2.8</a>) </dd> <dt><code>s.warn(<i>string</i>)</code></dt> <dd> writes a sent <code>string</code> to the error log on the <code>warning</code> level of logging </dd> </dl>

<h4 id="core">Core</h4>
<h4 id="core_global">Global</h4>
<h4 id="process">Process</h4>
<p> The <code>process</code> object is a global object that provides information about the current process (<a href="../changes/#njs0.3.3">0.3.3</a>). </p>
 <dl class="compact"> <dt id="process_argv"><code>process.argv</code></dt> <dd> Returns an array that contains the command line arguments passed when the current process was launched. </dd> <dt id="process_env"><code>process.env</code></dt> <dd> Returns an object containing the user environment. <blockquote class="note"> By default, nginx removes all environment variables inherited from its parent process except the TZ variable. Use the <a href="../../ngx_core_module/#env">env</a> directive to preserve some of the inherited variables. </blockquote> </dd> <dt id="process_pid"><code>process.pid</code></dt> <dd> Returns the PID of the current process. </dd> <dt id="process_ppid"><code>process.ppid</code></dt> <dd> Returns the PID of the current parent process. </dd> </dl>

<h4 id="core_object">Object</h4>
<p> The <code>Object</code> constructor corresponds to a standard JS object. </p> <dl class="compact"> <dt id="object_entries"><code>Object.entries(<i>object</i>)</code></dt> <dd> returns an array of all enumerable property <code>[key, value]</code> pairs of the given <code>object</code> (<a href="../changes/#njs0.2.7">0.2.7</a>). </dd> <dt id="object_values"><code>Object.values(<i>object</i>)</code></dt> <dd> returns an array of all enumerable property values of the given <code>object</code> (<a href="../changes/#njs0.2.7">0.2.7</a>). </dd> </dl>

<h4 id="string">String</h4>
<p> There are two types of strings in njs: a Unicode string (default) and a byte string. </p>
<p> A Unicode string corresponds to an ECMAScript string which contains Unicode characters. </p>
<p> Byte strings contain a sequence of bytes and are used to serialize Unicode strings to external data and deserialize from external sources. For example, the <a href="#string_toutf8">toUTF8()</a> method serializes a Unicode string to a byte string using UTF8 encoding: </p> <pre data-language="nginx">
&gt;&gt; '£'.toUTF8().toString('hex')
'c2a3'  /* C2 A3 is the UTF8 representation of 00A3 ('£') code point */
</pre>
<p> The <a href="#string_tobytes">toBytes()</a> method serializes a Unicode string with code points up to 255 into a byte string, otherwise, <code>null</code> is returned: </p> <pre data-language="nginx">
&gt;&gt; '£'.toBytes().toString('hex')
'a3'  /* a3 is a byte equal to 00A3 ('£') code point  */
</pre>
<p> Only byte strings can be converted to different encodings. For example, a string cannot be encoded to <code>hex</code> directly: </p> <pre data-language="nginx">
&gt;&gt; 'αβγδ'.toString('base64')
TypeError: argument must be a byte string
    at String.prototype.toString (native)
    at main (native)
</pre>
<p> To convert a Unicode string to hex, first, it should be converted to a byte string and then to hex: </p> <pre data-language="nginx">
&gt;&gt; 'αβγδ'.toUTF8().toString('base64')
'zrHOss6zzrQ='
</pre>
 <dl class="compact"> <dt id="string_bytesfrom"><code>String.bytesFrom(<i>array</i>
| <i>string</i>, <i>encoding</i>)</code></dt> <dd> (njs specific) Creates a byte string either from an array that contains octets, or from an encoded string (<a href="../changes/#njs0.2.3">0.2.3</a>). The encoding can be <code>hex</code>, <code>base64</code>, and <code>base64url</code>. <pre data-language="nginx">
&gt;&gt; String.bytesFrom([0x62, 0x75, 0x66, 0x66, 0x65, 0x72])
'buffer'

&gt;&gt; String.bytesFrom('YnVmZmVy', 'base64')
'buffer'
</pre> </dd> <dt id="string_fromcharcode"><code>String.fromCharCode(<i>CharCode1</i>[, ...[,
<i>CharCodeN</i>]])</code></dt> <dd> Returns a string from one or more Unicode code points. <pre data-language="nginx">
&gt;&gt; String.fromCharCode(97, 98, 99, 100)
'abcd'
</pre> </dd> <dt id="string_fromcodepoint"><code>String.fromCodePoint(<i>codePoint1</i>[, ...[,
<i>codePoint2</i>]])</code></dt> <dd> Returns a string from one or more Unicode code points. <pre data-language="nginx">
&gt;&gt; String.fromCodePoint(97, 98, 99, 100)
'abcd'
</pre> </dd> <dt id="string_charat"><code>String.prototype.charAt(<i>index</i>)</code></dt> <dd> Returns a string representing one Unicode code unit at the specified <code>index</code>; empty string if index is out of range. The index can be an integer between 0 and 1-less-than the length of the string. If no index is provided, the default is <code>0</code>, so the first character in the string is returned. </dd> <dt id="string_codepointat"><code>String.prototype.CodePointAt(<i>position</i>)</code></dt> <dd> Returns a number representing the code point value of the character at the given <code>position</code>; <code>undefined</code> if there is no element at position. <pre data-language="nginx">
&gt;&gt; 'ABCD'.codePointAt(3);
68
</pre> </dd> <dt id="string_concat"><code>String.prototype.concat(<i>string1</i>[, ...,
<i>stringN</i>])</code></dt> <dd> Returns a string that contains the concatenation of specified <code>strings</code>. <pre data-language="nginx">
&gt;&gt; "a".concat("b", "c")
'abc'
</pre> </dd> <dt id="string_endswith"><code>String.prototype.endsWith(<i>searchString</i>[,
<i>length</i>])</code></dt> <dd> Returns <code>true</code> if a string ends with the characters of a specified string, otherwise <code>false</code>. The optional <code>length</code> parameter is the the length of string. If omitted, the default value is the length of the string. <pre data-language="nginx">
&gt;&gt; 'abc'.endsWith('abc')
true
&gt;&gt; 'abca'.endsWith('abc')
false
</pre> </dd> <dt id="string_frombytes"><code>String.prototype.fromBytes(<i>start</i>[,
<i>end</i>])</code></dt> <dd> (njs specific) Returns a new Unicode string from a byte string where each byte is replaced with a corresponding Unicode code point. </dd> <dt id="string_fromutf8"><code>String.prototype.fromUTF8(<i>start</i>[,
<i>end</i>])</code></dt> <dd> (njs specific) Converts a byte string containing a valid UTF8 string into a Unicode string, otherwise <code>null</code> is returned. </dd> <dt id="string_includes"><code>String.prototype.includes(<i>searchString</i>[,
<i>position</i>]))</code></dt> <dd> Returns <code>true</code> if a string is found within another string, otherwise <code>false</code>. The optional <code>position</code> parameter is the position within the string at which to begin search for <code>searchString</code>. Default value is 0. <pre data-language="nginx">
&gt;&gt; 'abc'.includes('bc')
true
</pre> </dd> <dt id="string_indexof"><code>String.prototype.indexOf(<i>searchString</i>[,
<i>fromIndex</i>])</code></dt> <dd> Returns the position of the first occurrence of the <code>searchString</code>. The search is started at <code>fromIndex</code>. Returns <code><i>-1</i></code> if the value is not found. The <code>fromIndex</code> is an integer, default value is 0. If <code>fromIndex</code> is lower than 0 or greater than <a href="#string_length">String.prototype.length</a>, the search starts at index <code><i>0</i></code> and <code><i>String.prototype.length</i></code>. <pre data-language="nginx">
&gt;&gt; 'abcdef'.indexOf('de', 2)
3
</pre> </dd> <dt id="string_lastindexof"><code>String.prototype.lastIndexOf(<i>searchString</i>[,
<i>fromIndex</i>])</code></dt> <dd> Returns the position of the last occurrence of the <code>searchString</code>, searching backwards from <code>fromIndex</code>. Returns <code><i>-1</i></code> if the value is not found. If <code>searchString</code> is empty, then <code>fromIndex</code> is returned. <pre data-language="nginx">
&gt;&gt; "nginx".lastIndexOf("gi")
1
</pre> </dd> <dt id="string_length"><code>String.prototype.length</code></dt> <dd> Returns the length of the string. <pre data-language="nginx">
&gt;&gt; 'αβγδ'.length
4
</pre> </dd> <dt id="string_match"><code>String.prototype.match([<i>regexp</i>])</code></dt> <dd> Matches a string against a <code>regexp</code>. <pre data-language="nginx">
&gt;&gt; 'nginx'.match( /ng/i )
'ng'
</pre> </dd> <dt id="string_padend"><code>String.prototype.padEnd(<i>length</i>
[, <i>string</i>])</code></dt> <dd> Returns a string of a specified <code>length</code> with the pad <code>string</code> applied to the end of the specified string (<a href="../changes/#njs0.2.3">0.2.3</a>). <pre data-language="nginx">
&gt;&gt; '1234'.padEnd(8, 'abcd')
'1234abcd'
</pre> </dd> <dt id="string_padstart"><code>String.prototype.padStart(<i>length</i>
[, <i>string</i>])</code></dt> <dd> Returns a string of a specified <code>length</code> with the pad <code>string</code> applied to the start of the specified string (<a href="../changes/#njs0.2.3">0.2.3</a>). <pre data-language="nginx">
&gt;&gt; '1234'.padStart(8, 'abcd')
'abcd1234'
</pre> </dd> <dt id="string_repeat"><code>String.prototype.repeat(<i>number</i>)</code></dt> <dd> Returns a string with the specified <code>number</code> of copies of the string. <pre data-language="nginx">
&gt;&gt; 'abc'.repeat(3)
'abcabcabc'
</pre> </dd> <dt id="string_replace"><code>String.prototype.replace([<i>regexp</i>|<i>string</i>[,
<i>string</i>|<i>function</i>]])</code></dt> <dd> Returns a new string with matches of a pattern (<code>string</code> or a <code>regexp</code>) replaced by a <code>string</code> or a <code>function</code>. <pre data-language="nginx">
&gt;&gt; 'abcdefgh'.replace('d', 1)
'abc1efgh'
</pre> </dd> <dt id="string_search"><code>String.prototype.search([<i>regexp</i>])</code></dt> <dd> Searches for a string using a <code>regexp</code> <pre data-language="nginx">
&gt;&gt; 'abcdefgh'.search('def')
3
</pre> </dd> <dt id="string_slice"><code>String.prototype.slice(<i>start</i>[,
<i>end</i>])</code></dt> <dd> Returns a new string containing a part of an original string between <code>start</code> and <code>end</code> or from <code>start</code> to the end of the string. <pre data-language="nginx">
&gt;&gt; 'abcdefghijklmno'.slice(NaN, 5)
'abcde'
</pre> </dd> <dt id="string_split"><code>String.prototype.split(([<i>string</i>|<i>regexp</i>[,
<i>limit</i>]]))</code></dt> <dd> Returns match of a string against a <code>regexp</code>. The optional <code>limit</code> parameter is an integer that specifies a limit on the number of splits to be found. <pre data-language="nginx">
&gt;&gt; 'abc'.split('')
[
 'a',
 'b',
 'c'
]
</pre> </dd> <dt id="string_startswith"><code>String.prototype.startsWith(<i>searchString</i>[,
<i>position</i>])</code></dt> <dd> Returns <code>true</code> if a string begins with the characters of a specified string, otherwise <code>false</code>. The optional <code>position</code> parameter is the position in this string at which to begin search for <code>searchString</code>. Default value is 0. <pre data-language="nginx">
&gt;&gt; 'abc'.startsWith('abc')
true
&gt; 'aabc'.startsWith('abc')
false
</pre> </dd> <dt id="string_substr"><code>String.prototype.substr(<i>start</i>[,
<i>length</i>])</code></dt> <dd> Returns the part of the string of the specified <code>length</code> from <code>start</code> or from <code>start</code> to the end of the string. <pre data-language="nginx">
&gt;&gt;  'abcdefghijklmno'.substr(3, 5)
'defgh'
</pre> </dd> <dt id="string_substring"><code>String.prototype.substring(<i>start</i>[,
<i>end</i>])</code></dt> <dd> Returns the part of the string between <code>start</code> and <code>end</code> or from <code>start</code> to the end of the string. <pre data-language="nginx">
&gt;&gt; 'abcdefghijklmno'.substring(3, 5)
'de'
</pre> </dd> <dt id="string_tobytes"><code>String.prototype.toBytes(start[,
end])</code></dt> <dd> (njs specific) Serializes a Unicode string to a byte string. Returns <code>null</code> if a character larger than 255 is found in the string. </dd> <dt id="string_tolowercase"><code>String.prototype.toLowerCase()</code></dt> <dd> Converts a string to lower case. The method supports only simple Unicode folding. <pre data-language="nginx">
&gt;&gt; 'ΑΒΓΔ'.toLowerCase()
'αβγδ'
</pre> </dd> <dt><code>String.prototype.toString([<i>encoding</i>])</code></dt> <dd> <p> If no <code>encoding</code> is specified, returns a specified Unicode string or byte string as in ECMAScript. </p> <p> (njs specific) If <code>encoding</code> is specified, encodes a <a href="#string_tobytes">byte string</a> to <code>hex</code>, <code>base64</code>, or <code>base64url</code>. </p> <pre data-language="nginx">
&gt;&gt;  'αβγδ'.toUTF8().toString('base64url')
'zrHOss6zzrQ'
</pre> </dd> <dt id="string_touppercase"><code>String.prototype.toUpperCase()</code></dt> <dd> Converts a string to upper case. The method supports only simple Unicode folding. <pre data-language="nginx">
&gt;&gt; 'αβγδ'.toUpperCase()
'ΑΒΓΔ'
</pre> </dd> <dt id="string_toutf8"><code>String.prototype.toUTF8(<i>start</i>[,
<i>end</i>])</code></dt> <dd> (njs specific) Serializes a Unicode string to a byte string using UTF8 encoding. <pre data-language="nginx">
&gt;&gt; 'αβγδ'.toUTF8().length
8
&gt;&gt; 'αβγδ'.length
4
</pre> </dd> <dt id="string_trim"><code>String.prototype.trim()</code></dt> <dd> Removes whitespaces from both ends of a string. <pre data-language="nginx">
&gt;&gt; '   abc  '.trim()
'abc'
</pre> </dd> <dt id="encodeuri"><code>encodeURI(<i>URI</i>)</code></dt> <dd> Encodes a URI by replacing each instance of certain characters by one, two, three, or four escape sequences representing the UTF-8 encoding of the character <pre data-language="nginx">
&gt;&gt; encodeURI('012αβγδ')
'012%CE%B1%CE%B2%CE%B3%CE%B4'
</pre> </dd> <dt id="encodeuricomponent"><code>encodeURIComponent(<i>encodedURIString</i>)</code></dt> <dd> Encodes a URI by replacing each instance of certain characters by one, two, three, or four escape sequences representing the UTF-8 encoding of the character. <pre data-language="nginx">
&gt;&gt; encodeURIComponent('[@?=')
'%5B%40%3F%3D'
</pre> </dd> <dt id="decodeuri"><code>decodeURI(<i>encodedURI</i>)</code></dt> <dd> Decodes a previously <a href="#encodeuri">encoded</a> URI. <pre data-language="nginx">
&gt;&gt; decodeURI('012%CE%B1%CE%B2%CE%B3%CE%B4')
'012αβγδ'
</pre> </dd> <dt id="decodeuricomponent"><code>decodeURIComponent(<i>decodedURIString</i>)</code></dt> <dd> Decodes an encoded component of a previously encoded URI. <pre data-language="nginx">
&gt;&gt; decodeURIComponent('%5B%40%3F%3D')
'[@?='
</pre> </dd> </dl>

<h4 id="core_json">JSON</h4>
<p> The <code>JSON</code> object (ES 5.1) provides functions to convert njs values to and from JSON format. </p> <dl class="compact"> <dt id="core_json_parse"><code>JSON.parse(<i>string</i>[,
<i>reviver</i>])</code></dt> <dd> Converts a <code>string</code> that represents JSON data into an njs object (<code>{...}</code>) or array (<code>[...]</code>). The optional <code>reviver</code> parameter is a function (key, value) that will be called for each (key,value) pair and can transform the value. </dd> <dt id="core_json_stringify"><code>JSON.stringify(<i>value</i>[,
<i>replacer</i>] [, <i>space</i>])</code></dt> <dd> Converts an njs object back to JSON. The obligatory <code>value</code> parameter is generally a JSON <code>object</code> or <code>array</code> that will be converted. If the value has a <code>toJSON()</code> method, it defines how the object will be serialized. The optional <code>replacer</code> parameter is a <code>function</code> or <code>array</code> that transforms results. The optional <code>space</code> parameter is a <code>string</code> or <code>number</code>. If it is a <code>number</code>, it indicates the number of white spaces placed before a result (no more than 10). If it is a <code>string</code>, it is used as a white space (or first 10 characters of it). If omitted or is <code>null</code>, no white space is used. </dd> </dl>

 <pre data-language="nginx">
&gt;&gt; var json = JSON.parse('{"a":1, "b":true}')
&gt;&gt; json.a
1

&gt;&gt; JSON.stringify(json)
'{"a":1,"b":true}'

&gt;&gt; JSON.stringify({ x: [10, undefined, function(){}] })
'{"x":[10,null,null]}'

&gt;&gt; JSON.stringify({"a":1, "toJSON": function() {return "xxx"}})
'"xxx"'

# Example with function replacer

&gt;&gt; function replacer(key, value) {return (typeof value === 'string') ? undefined : value}
&gt;&gt;JSON.stringify({a:1, b:"b", c:true}, replacer)
'{"a":1,"c":true}'
</pre>

<h4 id="crypto">Crypto</h4>
<p> The Crypto module provides cryptographic functionality support. The Crypto module object is returned by <code>require('crypto')</code>. </p>
 <dl class="compact"> <dt id="crypto_createhash"><code>crypto.createHash(<i>algorithm</i>)</code></dt> <dd> Creates and returns a <a href="#crypto_hash">Hash</a> object that can be used to generate hash digests using the given <code><i>algorithm</i></code>. The algorighm can be <code>md5</code>, <code>sha1</code>, and <code>sha256</code>. </dd> <dt id="crypto_createhmac"><code>crypto.createHmac(<i>algorithm</i>,
<i>secret key</i>)</code></dt> <dd> Creates and returns an <a href="#crypto_hmac">HMAC</a> object that uses the given <code><i>algorithm</i></code> and <code><i>secret key</i></code>. The algorighm can be <code>md5</code>, <code>sha1</code>, and <code>sha256</code>. </dd> </dl>

<h4 id="crypto_hash">Hash</h4>
 <dl class="compact"> <dt><code>hash.update(<i>data</i>)</code></dt> <dd> Updates the hash content with the given <code><i>data</i></code>. </dd> <dt><code>hash.digest([<i>encoding</i>])</code></dt> <dd> Calculates the digest of all of the data passed using <code>hash.update()</code>. The encoding can be <code>hex</code>, <code>base64</code>, and <code>base64url</code>. If encoding is not provided, a byte string is returned. </dd> </dl>

 <pre data-language="nginx">
&gt;&gt; var cr = require('crypto')
undefined

&gt;&gt; cr.createHash('sha1').update('A').update('B').digest('base64url')
'BtlFlCqiamG-GMPiK_GbvKjdK10'
</pre>

<h4 id="crypto_hmac">HMAC</h4>
 <dl class="compact"> <dt><code>hmac.update(<i>data</i>)</code></dt> <dd> Updates the HMAC content with the given <code><i>data</i></code>. </dd> <dt><code>hmac.digest([<i>encoding</i>])</code></dt> <dd> Calculates the HMAC digest of all of the data passed using <code>hmac.update()</code>. The encoding can be <code>hex</code>, <code>base64</code>, and <code>base64url</code>. If encoding is not provided, a byte string is returned. </dd> </dl>

 <pre data-language="nginx">
&gt;&gt; var cr = require('crypto')
undefined

&gt;&gt; cr.createHmac('sha1', 'secret.key').update('AB').digest('base64url')
'Oglm93xn23_MkiaEq_e9u8zk374'
</pre>

<h4 id="njs_api_timers">Timers</h4>
 <dl class="compact"> <dt id="cleartimeout"><code>clearTimeout(<i>timeout</i>)</code></dt> <dd> Cancels a <code>timeout</code> object created by <a href="#settimeout">setTimeout()</a>. </dd> <dt id="settimeout"><code>setTimeout(<i>function</i>,
<i>ms</i>[, <i>arg1</i>, <i>argN</i>])</code></dt> <dd> Calls a <code>function</code> after a specified number of <code>milliseconds</code>. One or more optional <code>arguments</code> can be passed to the specified function. Returns a <code>timeout</code> object. <pre data-language="nginx">
function handler(v)
{
    // ...
}

t = setTimeout(handler, 12);

// ...

clearTimeout(t);
</pre> </dd> </dl>

<h4 id="njs_api_fs">File System</h4>
<p> The File System module provides operations with files. The module object is returned by <code>require('fs')</code>. </p> <dl class="compact"> <dt id="appendfilesync"><code>appendFileSync(<i>filename</i>,
<i>data</i>[, <i>options</i>])</code></dt> <dd> Synchronously appends specified <code>data</code> to a file with provided <code>filename</code>. If the file does not exist, it will be created. The <code>options</code> parameter is expected to be an object with the following keys: <dl class="compact"> <dt><code>mode</code></dt> <dd> mode option, by default is <code>0o666</code> </dd> <dt><code>flag</code></dt> <dd> file system <a href="#njs_api_fs_flags">flag</a>, by default is <code>a</code> </dd> </dl> </dd> <dt id="readfilesync"><code>readFileSync(<i>filename</i>[,
<i>options</i>])</code></dt> <dd> Synchronously returns the contents of the file with provided <code>filename</code>. The <code>options</code> parameter holds <code>string</code> that specifies encoding. If not specified, a <a href="#string_tobytes">byte string</a> is returned. If <code>utf8</code> encoding is specified, a Unicode string is returned. Otherwise, <code>options</code> is expected to be an object with the following keys: <dl class="compact"> <dt><code>encoding</code></dt> <dd> encoding, by default is not specified. The encoding can be <code>utf8</code> </dd> <dt><code>flag</code></dt> <dd> file system <a href="#njs_api_fs_flags">flag</a>, by default is <code>r</code> </dd> </dl> <pre data-language="nginx">
&gt;&gt; var fs = require('fs')
undefined
&gt;&gt; var file = fs.readFileSync('/file/path.tar.gz')
undefined
&gt;&gt; var gzipped = /^\x1f\x8b/.test(file); gzipped
true
</pre> </dd> <dt id="writefilesync"><code>writeFileSync(<i>filename</i>,
<i>data</i>[,
<i>options</i>])</code></dt> <dd> Synchronously writes <code>data</code> to a file with provided <code>filename</code>. If the file does not exist, it will be created, if the file exists, it will be replaced. The <code>options</code> parameter is expected to be an object with the following keys: <dl class="compact"> <dt><code>mode</code></dt> <dd> mode option, by default is <code>0o666</code> </dd> <dt><code>flag</code></dt> <dd> file system <a href="#njs_api_fs_flags">flag</a>, by default is <code>w</code> </dd> </dl> <pre data-language="nginx">
&gt;&gt; var fs = require('fs')
undefined
&gt;&gt; var file = fs.writeFileSync('hello.txt', 'Hello world')
undefined
</pre> </dd> </dl>

<h4 id="njs_api_fs_flags">File System Flags</h4>
<p> The <code>flag</code> option can accept the following values: </p> <ul> <li> <code>a</code> — open a file for appending. The file is created if it does not exist </li> <li> <code>ax</code> — the same as <code>a</code> but fails if the file already exists </li> <li> <code>a+</code> — open a file for reading and appending. If the file does not exist, it will be created </li> <li> <code>ax+</code> — the same as <code>a+</code> but fails if the file already exists </li> <li> <code>as</code> — open a file for appending in synchronous mode. If the file does not exist, it will be created </li> <li> <code>as+</code> — open a file for reading and appending in synchronous mode. If the file does not exist, it will be created </li> <li> <code>r</code> — open a file for reading. An exception occurs if the file does not exist </li> <li> <code>r+</code> — open a file for reading and writing. An exception occurs if the file does not exist </li> <li> <code>rs+</code> — open a file for reading and writing in synchronous mode. Instructs the operating system to bypass the local file system cache </li> <li> <code>w</code> — open a file for writing. If the file does not exist, it will be created. If the file exists, it will be replaced </li> <li> <code>wx</code> — the same as <code>w</code> but fails if the file already exists </li> <li> <code>w+</code> — open a file for reading and writing. If the file does not exist, it will be created. If the file exists, it will be replaced </li> <li> <code>wx+</code> — the same as <code>w+</code> but fails if the file already exists </li> </ul>
<div class="_attribution">
  <p class="_attribution-p">
    © 2002-2019 Igor Sysoev<br>© 2011-2019 Nginx, Inc.<br>Licensed under the BSD License.<br>
    <a href="https://nginx.org/en/docs/njs/reference.html" class="_attribution-link" target="_blank">https://nginx.org/en/docs/njs/reference.html</a>
  </p>
</div>

				
			</div>
			<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
</amp-auto-ads>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
